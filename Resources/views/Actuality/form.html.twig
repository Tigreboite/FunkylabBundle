{# Generated by Tigreboite\FunkylabBundle 2015-12-10 03:29:09 #}
{% extends ajax
? '@TigreboiteFunkylab/popin.html.twig'
: '@TigreboiteFunkylab/layout.html.twig' %}

{% block content -%}
    <div class="modal-body">
        <div class="row">
            <form method="post"
                  action="{% if app.request.get('_route') == "admin_actuality_edit" %}{{ path('admin_actuality_update',{'id':entity.id}) }}{% else %}{{ path('admin_actuality_create') }}{% endif %}"
                  role="form" enctype="multipart/form-data">

                {% if app.request.get('_route') == "admin_actuality_edit" %}
                    <input type="hidden" name="_method" value="PUT">
                {% endif %}

                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a href="#detail" role="tab" data-toggle="tab">Detail</a></li>
                    <li><a href="#seo" role="tab" data-toggle="tab">SEO</a></li>
                    <li><a href="#config" role="tab" data-toggle="tab">Configuration</a></li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane active" id="detail">
                        <div class="box box-primary">
                            <div class="box-body">
                                <div class="col-md-6">

                                    <div class="form-group">
                                        <label for="{{ form.title.vars.id }}">Titre</label>
                                        {{ form_widget(form.title, {'attr':{'class': 'form-control'}}) }}
                                    </div>
                                    <div class="form-group">
                                        <label for="{{ form.summary.vars.id }}">Résumé</label>
                                        {{ form_widget(form.summary, {'attr':{'class': 'form-control wysiwyg'}}) }}
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    {#<div class="form-group">
                                        <label for="{{ form.category.vars.id }}">Categorie</label>
                                        {{ form_widget(form.category, {'attr':{'class': 'form-control'}}) }}
                                    </div>#}
                                    <div class="form-group">
                                        <label for="id-loader-image">Image</label>
                                        {{ form_widget(form.image) }}
                                        <div id="{{ form.image.vars.id }}-preview">
                                            {% if entity.image %}
                                                <img src="/{{ entity.image }}" style="max-width:128px;"/>
                                            {% endif %}
                                        </div>
                                        <input {% if entity.image is not empty %}style="display:none;"{% endif %}
                                               type="file" id="id-loader-image" data-after="{{ form.image.vars.id }}"
                                               name="file" class="file-loader-image"
                                               data-url="{{ path('admin_page_upload') }}"/>
                                        <span class="image-remove btn btn-danger btn-xs"
                                              {% if entity.image is empty %}style="display:none;"{% endif %}> <i
                                                    class="fa fa-remove"></i></span>
                                    </div>
                                    <div class="form-group">
                                        <label for="{{ form.tags.vars.id }}">Tags</label>
                                        {{ form_widget(form.tags, {'attr':{'class': 'form-control'}}) }}
                                    </div>
                                </div>


                            </div>
                            {{ form_widget(form._token) }}
                        </div>
                    </div>

                    <div class="tab-pane" id="seo">
                        {% include "@TigreboiteFunkylab/Form/seo-form.html.twig" with {'form':form, 'entity':entity} %}
                    </div>

                    <div class="tab-pane" id="config">
                        <div class="box box-primary">
                            <div class="box-body">

                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="{{ form.published.vars.id }}">Publié</label>
                                        {{ form_widget(form.published, {'attr':{'class': 'form-control'}}) }}
                                    </div>
                                    <div class="form-group">
                                        <label for="{{ form.mea.vars.id }}">Mettre en avant</label>
                                        {{ form_widget(form.mea, {'attr':{'class': 'form-control'}}) }}
                                    </div>
                                    <div class="form-group">
                                        <label for="{{ form.dateStart.vars.id }}">Date début</label>
                                        {{ form_widget(form.dateStart, {'attr':{'class': 'form-control date'}}) }}
                                    </div>
                                    <div class="form-group">
                                        <label for="{{ form.dateEnd.vars.id }}">Date fin</label>
                                        {{ form_widget(form.dateEnd, {'attr':{'class': 'form-control date'}}) }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn btn-success btn-lg pull-left"><i class="fa fa-check"></i> Confirmer</button>
                    <button type="button" class="btn btn-default  btn-lg" data-dismiss="modal">Annuler</button>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

{% block callback_popin %}
    <script type="text/javascript">
        function callBackAfterSubmit() {
            table.draw();
        }
        $('.date').datepicker({
            buttonImageOnly: true,
            changeMonth: true,
            changeYear: true,
            dateFormat: 'dd/mm/yy',
            yearRange: "-1:+2"
        });
        $('.wysiwyg').froalaEditor({
            inlineMode: false,
            buttons: ["bold", "italic", "underline", "formatBlock", "sep", "insertUnorderedList", "sep", "createLink", "insertImage", "insertVideo", "sep", "undo", "redo", "html"],
            imagesLoadURL: Routing.generate('admin_media_list') + "?dir=page",
            imageDeleteURL: Routing.generate('admin_media_delete') + "?dir=page",
            blockTags: {
                n: 'Normal',
                h2: 'Heading 2',
                h3: 'Heading 3',
                h4: 'Heading 4'
            },
            defaultImageAlignment: "left",
            defaultVideoAlignment: "left",
            imageUploadURL: Routing.generate('upload_image_wysiwyg'),
            imageUploadParams: {id: "my_editor"}
        });
    </script>
{% endblock %}
